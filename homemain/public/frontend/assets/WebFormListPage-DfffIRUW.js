import{_ as S,T as W,r as y,A as R,X as z,a as q,o as n,b as d,d as t,t as g,f as h,i as $,e as k,w as _,H as A,a0 as M,u as i,F as w,k as C,n as I,q as V,Y as L,V as J}from"./index-CBDyEeFS.js";const O={class:"max-w-7xl mx-auto p-4 space-y-6"},U={class:"bg-white dark:bg-gray-900 shadow-lg rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},G={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 px-6 py-6 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800"},X={class:"min-w-0 flex-1"},Y={class:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white truncate"},K={class:"flex items-center gap-3 flex-shrink-0"},Q=["disabled"],Z={class:"overflow-hidden"},ee={class:"overflow-x-auto"},te={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},se={class:"bg-gray-50 dark:bg-gray-800"},ae={scope:"col",class:"w-12 px-6 py-3"},re=["disabled"],oe={class:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700"},le={class:"px-6 py-4"},ne=["value"],de={class:"px-6 py-4 text-sm font-medium text-gray-900 dark:text-gray-100"},ie={class:"max-w-xs"},ue=["innerHTML"],ce={key:1,class:"truncate block"},ge=["title"],me={class:"px-6 py-4 text-right"},ye={class:"flex items-center justify-end gap-2"},pe=["onClick","disabled"],xe={key:0},fe={class:"flex items-center justify-between px-6 py-4 bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700"},be={class:"flex items-center gap-2"},ve={class:"flex items-center gap-4"},he={class:"text-sm text-gray-700 dark:text-gray-300"},ke={class:"text-sm text-gray-500 dark:text-gray-400"},_e={class:"flex items-center gap-2"},we={class:"bg-gray-50 dark:bg-gray-800 rounded-lg"},Ce={class:"px-4 pb-4"},Le={class:"bg-gray-900 text-gray-100 rounded-lg p-4 text-xs overflow-x-auto border"},Fe={__name:"WebFormListPage",setup(Ne){const F=W(),x=y(F.params.name),u=y(null),m=y(!1),f=y(""),b=y([]),o=y([]),p=y(!1);let a=null;async function N(){m.value=!0,u.value=null;try{const s=await L("frappe.client.get",{doctype:"Web Form",name:x.value});u.value=s?.message||s||null,f.value=u.value?.doc_type,b.value=u.value?.list_columns&&u.value.list_columns.length?u.value.list_columns:(u.value?.web_form_fields||[]).filter(e=>!!e.fieldname&&e.fieldtype!=="Section Break"&&e.fieldtype!=="Column Break").map(e=>({fieldname:e.fieldname,label:e.label,fieldtype:e.fieldtype})),B()}catch(s){u.value=null,console.error("[WebFormListPage] Error fetching webform:",s)}m.value=!1}function B(){!f.value||b.value.length===0||(a=J({doctype:f.value,fields:["name",...b.value.map(s=>s.fieldname)],orderBy:"modified desc",pageLength:10}),a.fetch(),o.value=[],p.value=!1)}function D(){p.value?o.value=(a?.data||[]).map(s=>s.name):o.value=[]}function P(){const s=(a?.data||[]).map(l=>l.name),e=s.filter(l=>o.value.includes(l));p.value=s.length>0&&e.length===s.length}async function j(s){if(confirm("Are you sure you want to delete this entry? This action cannot be undone."))try{m.value=!0,await L("frappe.client.delete",{doctype:f.value,name:s}),v("Entry deleted successfully!","success"),o.value=o.value.filter(e=>e!==s),P(),a&&a.reload&&await a.reload()}catch(e){v("Failed to delete: "+(e.message||e),"error"),console.error("[WebFormListPage] Error deleting entry:",e)}finally{m.value=!1}}async function E(){const s=o.value.length;if(confirm(`Are you sure you want to delete ${s} ${s===1?"entry":"entries"}? This action cannot be undone.`))try{m.value=!0;const e=o.value.map(l=>L("frappe.client.delete",{doctype:f.value,name:l}));await Promise.all(e),v(`${s} ${s===1?"entry":"entries"} deleted successfully!`,"success"),o.value=[],p.value=!1,a&&a.reload&&await a.reload()}catch(e){v("Failed to delete some entries: "+(e.message||e),"error"),console.error("[WebFormListPage] Error bulk deleting entries:",e)}finally{m.value=!1}}function v(s,e="info"){const l=document.createElement("div"),r=e==="success"?"bg-green-500":e==="error"?"bg-red-500":"bg-blue-500";l.className=`fixed top-4 right-4 ${r} text-white px-6 py-3 rounded-lg shadow-lg z-50 max-w-sm`,l.textContent=s,document.body.appendChild(l),setTimeout(()=>l.remove(),4e3)}function H(s){if(!s)return"";if(s.length===10&&s.includes("-"))return s.split("-").reverse().join("/");const e=new Date(s);return isNaN(e)?s:e.toLocaleDateString()}return R(N),z(()=>F.params.name,s=>{x.value=s,N()}),(s,e)=>{const l=q("router-link");return n(),d("div",O,[t("div",U,[t("div",G,[t("div",X,[t("h1",Y,g(u.value?.list_title||u.value?.title||x.value)+" List ",1),e[4]||(e[4]=t("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Manage your form submissions ",-1))]),t("div",K,[o.value.length>0?(n(),d("button",{key:0,onClick:E,disabled:m.value,class:"inline-flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold text-sm rounded-lg shadow-sm transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"},[e[5]||(e[5]=t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1-1H8a1 1 0 00-1 1v3M4 7h16"})],-1)),h(" Delete ("+g(o.value.length)+") ",1)],8,Q)):$("",!0),k(l,{to:`/form/${x.value}?new=1`,class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold text-sm rounded-lg shadow-sm transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"},{default:_(()=>e[6]||(e[6]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),t("span",{class:"hidden sm:inline"},"Add New Entry",-1),t("span",{class:"inline sm:hidden"},"Add",-1)])),_:1,__:[6]},8,["to"])])]),t("div",Z,[t("div",ee,[t("table",te,[t("thead",se,[t("tr",null,[t("th",ae,[A(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=r=>p.value=r),onChange:D,class:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",disabled:!i(a)?.data?.length},null,40,re),[[M,p.value]])]),e[7]||(e[7]=t("th",{scope:"col",class:"w-16 px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," # ",-1)),(n(!0),d(w,null,C(b.value,r=>(n(),d("th",{key:r.fieldname,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},g(r.label||r.fieldname),1))),128)),e[8]||(e[8]=t("th",{scope:"col",class:"w-20 px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Actions ",-1))])]),t("tbody",oe,[(n(!0),d(w,null,C(i(a)?.data||[],(r,T)=>(n(),d("tr",{key:r.name,class:I(["hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",{"bg-blue-50 dark:bg-blue-900/20":o.value.includes(r.name)}])},[t("td",le,[A(t("input",{type:"checkbox",value:r.name,"onUpdate:modelValue":e[1]||(e[1]=c=>o.value=c),onChange:P,class:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,40,ne),[[M,o.value]])]),t("td",de,g(T+1),1),(n(!0),d(w,null,C(b.value,c=>(n(),d("td",{key:c.fieldname,class:"px-6 py-4 text-sm text-gray-900 dark:text-gray-100"},[t("div",ie,[c.fieldtype==="Text Editor"?(n(),d("div",{key:0,class:"ql-editor read-mode line-clamp-2",innerHTML:r[c.fieldname]},null,8,ue)):c.fieldtype==="Date"?(n(),d("span",ce,g(H(r[c.fieldname])),1)):(n(),d("span",{key:2,class:"truncate block",title:r[c.fieldname]},g(r[c.fieldname]),9,ge))])]))),128)),t("td",me,[t("div",ye,[k(l,{to:`/form/${x.value}?doc=${r.name}`,class:"inline-flex items-center px-3 py-1 text-xs font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/50 dark:hover:bg-blue-900 rounded-md transition-colors"},{default:_(()=>e[9]||(e[9]=[h(" Edit ")])),_:2,__:[9]},1032,["to"]),t("button",{onClick:c=>j(r.name),disabled:m.value,class:"inline-flex items-center px-2 py-1 text-xs font-medium text-red-600 bg-red-50 hover:bg-red-100 dark:bg-red-900/50 dark:hover:bg-red-900 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete this entry"},e[10]||(e[10]=[t("svg",{class:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1-1H8a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,pe)])])],2))),128)),i(a)?.data?.length?$("",!0):(n(),d("tr",xe,e[11]||(e[11]=[t("td",{colspan:"99",class:"px-6 py-12 text-center"},[t("div",{class:"flex flex-col items-center justify-center space-y-3"},[t("svg",{class:"h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),t("div",null,[t("p",{class:"text-gray-500 dark:text-gray-400 font-medium"}," No records found "),t("p",{class:"text-gray-400 dark:text-gray-500 text-sm mt-1"}," Get started by adding your first entry ")])])],-1)])))])])])]),t("div",fe,[t("div",be,[k(i(V),{disabled:!i(a)?.hasPrev||i(a)?.page<=1,onClick:e[2]||(e[2]=r=>i(a).prev()),class:"px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},{default:_(()=>e[12]||(e[12]=[h(" Previous ")])),_:1,__:[12]},8,["disabled"])]),t("div",ve,[t("span",he," Page "+g(i(a)?.page||1),1),t("div",ke,g((i(a)?.data||[]).length)+" entries ",1)]),t("div",_e,[k(i(V),{disabled:!i(a)?.hasNext,onClick:e[3]||(e[3]=r=>i(a).next()),class:"px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},{default:_(()=>e[13]||(e[13]=[h(" Next ")])),_:1,__:[13]},8,["disabled"])])])]),t("details",we,[e[14]||(e[14]=t("summary",{class:"cursor-pointer p-4 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors"},[t("span",{class:"font-medium"},"Show raw webForm JSON")],-1)),t("div",Ce,[t("pre",Le,g(JSON.stringify(u.value,null,2)),1)])])])}}},$e=S(Fe,[["__scopeId","data-v-605cf1de"]]);export{$e as default};
//# sourceMappingURL=WebFormListPage-DfffIRUW.js.map
