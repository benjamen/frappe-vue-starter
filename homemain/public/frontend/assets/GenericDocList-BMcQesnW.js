import{T as H,x as P,r as m,V as O,X as q,A as X,Y as $,o as n,b as r,d as s,t as p,v as j,F as V,k as D,j as z,u as c,G as E,e as y,w as f,f as _,q as x,i as Y,z as N}from"./index-CBDyEeFS.js";const J={class:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-cyan-50 p-4"},K={class:"max-w-4xl mx-auto"},Q={class:"text-center mb-8"},W={class:"text-4xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-2"},Z={class:"text-gray-600"},ee={key:0,class:"bg-white/70 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-6 mb-8 hover:shadow-2xl transition-all duration-300"},te={key:1,class:"flex justify-center items-center py-12"},ae={key:2,class:"grid gap-4 mb-8"},le={key:0},oe={key:1,class:"flex items-center justify-between gap-4"},se={class:"flex-1"},ne={class:"font-semibold"},re={class:"flex items-center gap-2"},ie={key:3,class:"text-center py-16"},ue={class:"text-xl font-semibold text-gray-600 mb-2"},de={class:"text-gray-500"},pe={__name:"GenericDocList",setup(ce){const M=H(),d=P(()=>M.params.doctype||"ToDo"),S=m(""),B=m(""),w=m(""),v=m([]),g=m([]),i=O({doctype:d.value,fields:["name"],orderBy:"creation desc",start:0,pageLength:10});q(d,()=>{i.doctype=d.value,F(),i.fetch()}),X(()=>{F(),i.fetch()});async function F(){let t="",l="",a="";try{const{message:e}=await $("frappe.client.get_list",{doctype:"Frontend Page Config",filters:{doctype:d.value},fields:["page_title","page_subtitle","page_singular"],limit_page_length:1});Array.isArray(e)&&e.length&&(t=e[0].page_title,l=e[0].page_subtitle,a=e[0].page_singular)}catch{}const o=await $("frappe.desk.form.load.getdoctype",{doctype:d.value});let C=o?.message?.fields||o?.docs?.[0]?.fields||[];S.value=t||d.value,B.value=l||`List of ${d.value}`,w.value=a||d.value,g.value=C.filter(e=>e.in_list_view||e.bold).map(e=>({name:e.fieldname,label:e.label,type:L(e.fieldtype),options:e.fieldtype==="Select"&&e.options?e.options.split(`
`).filter(Boolean).map(h=>({value:h,label:h})):void 0})),v.value=C.filter(e=>!e.hidden&&!e.read_only&&!["Section Break","Column Break","Table","Button","HTML","Image"].includes(e.fieldtype)).map(e=>({name:e.fieldname,label:e.label,required:!!e.reqd,type:L(e.fieldtype),options:e.fieldtype==="Select"&&e.options?e.options.split(`
`).filter(Boolean).map(h=>({value:h,label:h})):void 0,placeholder:e.label})),i.fields=["name",...g.value.map(e=>e.name)],T()}function L(t){switch(t){case"Data":return"text";case"Text":case"Small Text":case"Long Text":case"Code":return"textarea";case"Int":case"Float":case"Currency":case"Percent":return"number";case"Date":return"date";case"Datetime":return"datetime-local";case"Time":return"time";case"Select":return"select";case"Check":return"checkbox";default:return"text"}}const b=m({});function T(){b.value=Object.fromEntries(v.value.map(t=>[t.name,t.options?.[0]?.value??""]))}q(v,T,{immediate:!0});async function R(){for(const t of v.value)if(t.required&&!b.value[t.name])return;try{await i.insert.submit({...b.value}),T(),await i.fetch()}catch(t){alert("Failed to add: "+t.message)}}const k=m(null),u=m(null);function A(t){k.value=t.name,u.value=N({doctype:d.value,name:t.name})}async function U(){if(!(!u.value||!u.value.doc))try{await u.value.setValue.submit({...u.value.doc}),k.value=null,u.value=null,await i.fetch()}catch(t){alert("Failed to save: "+t.message)}}function I(){k.value=null,u.value=null}async function G(t){if(confirm(`Delete ${w.value} "${t[g.value[0]?.name]}"?`))try{await N({doctype:d.value,name:t.name}).delete.submit(),await i.fetch()}catch(l){alert("Failed to delete: "+l.message)}}return(t,l)=>(n(),r("div",J,[s("div",K,[s("div",Q,[s("h1",W,p(S.value),1),s("p",Z,p(B.value),1)]),v.value.length?(n(),r("div",ee,[s("form",{onSubmit:j(R,["prevent"]),class:"flex flex-col sm:flex-row gap-4"},[(n(!0),r(V,null,D(v.value,a=>(n(),z(c(E),{key:a.name,modelValue:b.value[a.name],"onUpdate:modelValue":o=>b.value[a.name]=o,label:a.label,placeholder:a.placeholder||a.label||a.name,type:a.type,options:a.options,required:a.required,class:"w-full"},null,8,["modelValue","onUpdate:modelValue","label","placeholder","type","options","required"]))),128)),y(c(x),{type:"submit",variant:"solid",class:"!bg-gradient-to-r !from-indigo-600 !to-purple-600 !text-white hover:!from-indigo-700 hover:!to-purple-700 !shadow-lg hover:!shadow-xl transform hover:scale-105 transition-all duration-200"},{default:f(()=>[_(" Add "+p(w.value),1)]),_:1})],32)])):Y("",!0),c(i).data?c(i).data.length?(n(),r("div",ae,[(n(!0),r(V,null,D(c(i).data,a=>(n(),r("div",{key:a.name,class:"group bg-white/70 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6 hover:shadow-xl hover:scale-[1.02] transition-all duration-300"},[k.value===a.name&&u.value&&u.value.doc?(n(),r("div",le,[s("form",{onSubmit:j(U,["prevent"]),class:"flex flex-col sm:flex-row gap-4"},[(n(!0),r(V,null,D(g.value,o=>(n(),z(c(E),{key:o.name,modelValue:u.value.doc[o.name],"onUpdate:modelValue":C=>u.value.doc[o.name]=C,label:o.label,type:o.type,options:o.options,class:"w-full"},null,8,["modelValue","onUpdate:modelValue","label","type","options"]))),128)),y(c(x),{type:"submit",variant:"solid",size:"sm",class:"!bg-green-600 !text-white hover:!bg-green-700"},{default:f(()=>l[1]||(l[1]=[_(" 💾 Save ")])),_:1,__:[1]}),y(c(x),{type:"button",onClick:I,variant:"outline",size:"sm"},{default:f(()=>l[2]||(l[2]=[_(" ❌ Cancel ")])),_:1,__:[2]})],32)])):(n(),r("div",oe,[s("div",se,[(n(!0),r(V,null,D(g.value,o=>(n(),r("div",{key:o.name,class:"mb-1"},[s("span",ne,p(o.label||o.name)+": ",1),s("span",null,p(a[o.name]),1)]))),128))]),s("div",re,[y(c(x),{onClick:o=>A(a),variant:"ghost",size:"sm",class:"opacity-0 group-hover:opacity-100 transition-all duration-200 hover:!bg-blue-50 !text-blue-600"},{default:f(()=>l[3]||(l[3]=[_(" Edit ")])),_:2,__:[3]},1032,["onClick"]),y(c(x),{onClick:o=>G(a),variant:"ghost",size:"sm",class:"opacity-0 group-hover:opacity-100 transition-all duration-200 hover:!bg-red-50 !text-red-600"},{default:f(()=>l[4]||(l[4]=[_(" Delete ")])),_:2,__:[4]},1032,["onClick"])])]))]))),128))])):(n(),r("div",ie,[l[5]||(l[5]=s("div",{class:"w-24 h-24 mx-auto mb-6 bg-gradient-to-br from-indigo-100 to-purple-100 rounded-full flex items-center justify-center"},[s("svg",{class:"w-12 h-12 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),s("h3",ue," No "+p(S.value)+" yet ",1),s("p",de," Create your first "+p(w.value.toLowerCase())+" to get started! ",1)])):(n(),r("div",te,l[0]||(l[0]=[s("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-200 border-t-indigo-600"},null,-1),s("span",{class:"ml-3 text-gray-600 font-medium"},"Loading...",-1)])))])]))}};export{pe as default};
//# sourceMappingURL=GenericDocList-BMcQesnW.js.map
